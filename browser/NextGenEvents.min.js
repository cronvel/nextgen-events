(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.NextGenEvents=e()}})(function(){var e,t,n;return function i(e,t,n){function r(o,a){if(!t[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return r(n?n:t)},l,l.exports,i,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){"use strict";function i(){return Object.create(i.prototype)}t.exports=i;i.SYNC=-Infinity;i.init=function s(){Object.defineProperty(this,"__ngev",{value:{nice:i.SYNC,interruptible:false,recursion:0,contexts:{},events:{error:[],interrupt:[],newListener:[],removeListener:[]}}})};i.filterOutCallback=function(e,t){return e!==t};i.prototype.addListener=function o(e,t,n){var r={};if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}if(!e||typeof e!=="string"){throw new TypeError(".addListener(): argument #0 should be a non-empty string")}if(typeof t!=="function"){n=t;t=undefined}if(!n||typeof n!=="object"){n={}}r.fn=t||n.fn;r.id=typeof n.id==="string"?n.id:r.fn;r.once=!!n.once;r.async=!!n.async;r.nice=n.nice!==undefined?Math.floor(n.nice):i.SYNC;r.context=typeof n.context==="string"?n.context:null;if(typeof r.fn!=="function"){throw new TypeError(".addListener(): a function or an object with a 'fn' property which value is a function should be provided")}if(r.context&&typeof r.context==="string"&&!this.__ngev.contexts[r.context]){this.addListenerContext(r.context)}r.event=e;if(this.__ngev.events.newListener.length){this.emit("newListener",[r])}this.__ngev.events[e].push(r);return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function a(e,t,n){if(t&&typeof t==="object"){t.once=true}else if(n&&typeof n==="object"){n.once=true}else{n={once:true}}return this.addListener(e,t,n)};i.prototype.removeListener=function u(e,t){var n,r,s=[],o=[];if(!e||typeof e!=="string"){throw new TypeError(".removeListener(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}r=this.__ngev.events[e].length;for(n=0;n<r;n++){if(this.__ngev.events[e][n].id===t){o.push(this.__ngev.events[e][n])}else{s.push(this.__ngev.events[e][n])}}this.__ngev.events[e]=s;if(o.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",o)}return this};i.prototype.off=i.prototype.removeListener;i.prototype.removeAllListeners=function c(e){var t;if(!this.__ngev){i.init.call(this)}if(e){if(!e||typeof e!=="string"){throw new TypeError(".removeAllListener(): argument #0 should be undefined or a non-empty string")}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}t=this.__ngev.events[e];this.__ngev.events[e]=[];if(t.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",t)}}else{this.__ngev.events={}}return this};i.listenerWrapper=function l(e,t,n){var r,s;if(t.interrupt){return}if(e.async){if(n){s=n.serial;n.ready=!s}r=e.fn.apply(undefined,t.args.concat(function(n){t.listenersDone++;if(n&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=n;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}if(s){i.processQueue.call(t.emitter,e.context,true)}}))}else{r=e.fn.apply(undefined,t.args);t.listenersDone++}if(r&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=r;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}};var r=0;i.prototype.emit=function v(){var e;e={emitter:this};if(typeof arguments[0]==="number"){e.nice=Math.floor(arguments[0]);e.name=arguments[1];if(!e.name||typeof e.name!=="string"){throw new TypeError(".emit(): when argument #0 is a number, argument #1 should be a non-empty string")}if(typeof arguments[arguments.length-1]==="function"){e.callback=arguments[arguments.length-1];e.args=Array.prototype.slice.call(arguments,2,-1)}else{e.args=Array.prototype.slice.call(arguments,2)}}else{e.name=arguments[0];if(!e.name||typeof e.name!=="string"){throw new TypeError(".emit(): argument #0 should be an number or a non-empty string")}e.args=Array.prototype.slice.call(arguments,1);if(typeof arguments[arguments.length-1]==="function"){e.callback=arguments[arguments.length-1];e.args=Array.prototype.slice.call(arguments,1,-1)}else{e.args=Array.prototype.slice.call(arguments,1)}}return i.emitEvent(e)};i.emitEvent=function f(e){var t=e.emitter,n,s,o=0,a,u,c,l,v=[];if(!t.__ngev){i.init.call(t)}if(!t.__ngev.events[e.name]){t.__ngev.events[e.name]=[]}e.id=r++;e.listenersDone=0;if(e.nice===undefined||e.nice===null){e.nice=t.__ngev.nice}e.listeners=t.__ngev.events[e.name].length;t.__ngev.recursion++;l=t.__ngev.events[e.name].slice();for(n=0,s=l.length;n<s;n++){o++;a=l[n];u=a.context&&t.__ngev.contexts[a.context];if(u&&u.status===i.CONTEXT_DISABLED){continue}if(u){c=Math.max(e.nice,a.nice,u.nice)}else{c=Math.max(e.nice,a.nice)}if(a.once){t.__ngev.events[e.name]=t.__ngev.events[e.name].filter(i.filterOutCallback.bind(undefined,a));v.push(a)}if(u&&(u.status===i.CONTEXT_QUEUED||!u.ready)){u.queue.push({event:e,listener:a,nice:c})}else{try{if(c<0){if(t.__ngev.recursion>=-c){setImmediate(i.listenerWrapper.bind(t,a,e,u))}else{i.listenerWrapper.call(t,a,e,u)}}else{setTimeout(i.listenerWrapper.bind(t,a,e,u),c)}}catch(f){t.__ngev.recursion--;throw f}}}t.__ngev.recursion--;if(v.length&&t.__ngev.events.removeListener.length){t.emit("removeListener",v)}if(!o){if(e.name==="error"){if(e.args[0]){throw e.args[0]}else{throw Error("Uncaught, unspecified 'error' event.")}}if(e.callback){e.callback(undefined,e);delete e.callback}}return e};i.prototype.listeners=function h(e){if(!e||typeof e!=="string"){throw new TypeError(".listeners(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].slice()};i.listenerCount=function(e,t){if(!e||!(e instanceof i)){throw new TypeError(".listenerCount(): argument #0 should be an instance of NextGenEvents")}return e.listenerCount(t)};i.prototype.listenerCount=function(e){if(!e||typeof e!=="string"){throw new TypeError(".listenerCount(): argument #1 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].length};i.prototype.setNice=function p(e){if(!this.__ngev){i.init.call(this)}this.__ngev.nice=Math.floor(+e||0)};i.prototype.setInterruptible=function g(e){if(!this.__ngev){i.init.call(this)}this.__ngev.interruptible=!!e};i.prototype.setMaxListeners=function(){};i.noop=function(){};i.CONTEXT_ENABLED=0;i.CONTEXT_DISABLED=1;i.CONTEXT_QUEUED=2;i.prototype.addListenerContext=function _(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".addListenerContext(): argument #0 should be a non-empty string")}if(!t||typeof t!=="object"){t={}}if(!this.__ngev.contexts[e]){this.__ngev.contexts[e]=Object.create(i.prototype);this.__ngev.contexts[e].nice=i.SYNC;this.__ngev.contexts[e].ready=true;this.__ngev.contexts[e].status=i.CONTEXT_ENABLED;this.__ngev.contexts[e].serial=false;this.__ngev.contexts[e].queue=[]}if(t.nice!==undefined){this.__ngev.contexts[e].nice=Math.floor(t.nice)}if(t.status!==undefined){this.__ngev.contexts[e].status=t.status}if(t.serial!==undefined){this.__ngev.contexts[e].serial=!!t.serial}return this};i.prototype.disableListenerContext=function d(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_DISABLED;return this};i.prototype.enableListenerContext=function m(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".enableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_ENABLED;if(this.__ngev.contexts[e].queue.length>0){i.processQueue.call(this,e)}return this};i.prototype.queueListenerContext=function y(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".queueListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_QUEUED;return this};i.prototype.serializeListenerContext=function b(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".serializeListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].serial=t===undefined?true:!!t;return this};i.prototype.setListenerContextNice=function x(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".setListenerContextNice(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].nice=Math.floor(t);return this};i.prototype.destroyListenerContext=function w(e){var t,n,r,s,o=[];if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}for(r in this.__ngev.events){s=null;n=this.__ngev.events[r].length;for(t=0;t<n;t++){if(this.__ngev.events[r][t].context===e){s=[];o.push(this.__ngev.events[r][t])}else if(s){s.push(this.__ngev.events[r][t])}}if(s){this.__ngev.events[r]=s}}if(this.__ngev.contexts[e]){delete this.__ngev.contexts[e]}if(o.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",o)}return this};i.processQueue=function L(e,t){var n,r;if(!this.__ngev.contexts[e]){return}n=this.__ngev.contexts[e];if(t){n.ready=true}this.__ngev.recursion++;while(n.ready&&n.queue.length){r=n.queue.shift();if(r.event.interrupt){continue}try{if(r.nice<0){if(this.__ngev.recursion>=-r.nice){setImmediate(i.listenerWrapper.bind(this,r.listener,r.event,n))}else{i.listenerWrapper.call(this,r.listener,r.event,n)}}else{setTimeout(i.listenerWrapper.bind(this,r.listener,r.event,n),r.nice)}}catch(s){this.__ngev.recursion--;throw s}}this.__ngev.recursion--};i.on=i.prototype.on;i.once=i.prototype.once;i.off=i.prototype.off;i.Proxy=e("./Proxy.js")},{"./Proxy.js":2}],2:[function(e,t,n){"use strict";function i(){return i.create()}t.exports=i;var r=e("./NextGenEvents.js");var s="NextGenEvents/message";function o(){}i.create=function c(){var e=Object.create(i.prototype,{localServices:{value:{},enumerable:true},remoteServices:{value:{},enumerable:true}});return e};i.prototype.addLocalService=function l(e,t,n){this.localServices[e]=a.create(this,e,t,n);return this.localServices[e]};i.prototype.addRemoteService=function v(e){this.remoteServices[e]=u.create(this,e);return this.remoteServices[e]};i.prototype.destroy=function f(){var e=this;Object.keys(this.localServices).forEach(function(t){e.localServices[t].destroy();delete e.localServices[t]});Object.keys(this.remoteServices).forEach(function(t){e.remoteServices[t].destroy();delete e.remoteServices[t]});this.receive=this.send=o};i.prototype.push=function h(e){if(e.type!==s||!e.service||typeof e.service!=="string"||!e.event||typeof e.event!=="string"||!e.method){return}switch(e.method){case"event":return this.remoteServices[e.service]&&this.remoteServices[e.service].event(e);case"emit":return this.localServices[e.service]&&this.localServices[e.service].emit(e);case"listen":return this.localServices[e.service]&&this.localServices[e.service].listen(e);case"ignore":return this.localServices[e.service]&&this.localServices[e.service].ignore(e);default:return}};i.prototype.receive=function p(e){this.push(e)};i.prototype.send=function g(){throw new Error("The send() method of the Proxy MUST be extended/overwritten")};function a(e,t,n,i){return a.create(e,t,n,i)}i.LocalService=a;a.create=function _(e,t,n,i){var r=Object.create(a.prototype,{proxy:{value:e,enumerable:true},id:{value:t,enumerable:true},emitter:{value:n,writable:true,enumerable:true},events:{value:{},enumerable:true},canListen:{value:!!i.listen,writable:true,enumerable:true},canEmit:{value:!!i.emit,writable:true,enumerable:true},canAsync:{value:!!i.async,writable:true,enumerable:true},destroyed:{value:false,writable:true,enumerable:true}});Object.defineProperties(r,{forward:{value:a.forward.bind(r),enumerable:true}});return r};a.prototype.destroy=function d(){var e=this;Object.keys(this.events).forEach(function(t){e.emitter.off(t,e.events[t]);delete e.events[t]});this.emitter=null;this.destroyed=true};a.prototype.emit=function m(e){if(this.destroyed||!this.canEmit){return}var t={emitter:this.emitter,name:e.event,args:e.args||[]};r.emitEvent(t)};a.prototype.listen=function y(e){if(this.destroyed||!this.canListen||this.events[e.event]){return}this.events[e.event]=this.forward.bind(this,e.event);this.emitter.on(e.event,this.events[e.event])};a.prototype.ignore=function b(e){if(this.destroyed||!this.canListen||!this.events[e.event]){return}this.emitter.off(e.event,this.events[e.event]);this.events[e.event]=null};a.forward=function x(e){if(this.destroyed){return}this.proxy.send({type:s,service:this.id,method:"event",event:e,args:Array.prototype.slice.call(arguments,1)})};function u(e,t){return u.create(e,t)}i.RemoteService=u;u.create=function w(e,t){var n=Object.create(u.prototype,{proxy:{value:e,enumerable:true},id:{value:t,enumerable:true},emitter:{value:Object.create(r.prototype),writable:true,enumerable:true},events:{value:{},enumerable:true},destroyed:{value:false,writable:true,enumerable:true}});return n};u.prototype.destroy=function L(){var e=this;this.emitter.removeAllListeners();this.emitter=null;Object.keys(this.events).forEach(function(t){delete e.events[t]});this.destroyed=true};u.prototype.emit=function E(e){if(this.destroyed){return}this.proxy.send({type:s,service:this.id,method:"emit",event:e,args:Array.prototype.slice.call(arguments,1)})};u.prototype.addListener=function C(e,t,n){if(this.destroyed){return}this.emitter.addListener(e,t,n);if(!this.events[e]&&this.emitter.__ngev.events[e]&&this.emitter.__ngev.events[e].length){this.events[e]=true;this.proxy.send({type:s,service:this.id,method:"listen",event:e})}};u.prototype.on=u.prototype.addListener;u.prototype.once=r.prototype.once;u.prototype.removeListener=function T(e,t){if(this.destroyed){return}this.emitter.removeListener(e,t);if(this.events[e]&&(!this.emitter.__ngev.events[e]||!this.emitter.__ngev.events[e].length)){this.events[e]=false;this.proxy.send({type:s,service:this.id,method:"ignore",event:e})}};u.prototype.off=u.prototype.removeListener;u.prototype.event=function S(e){if(this.destroyed||!this.events[e.event]){return}var S={emitter:this.emitter,name:e.event,args:e.args||[]};r.emitEvent(S);var t=S.name;if(!this.emitter.__ngev.events[t]||!this.emitter.__ngev.events[t].length){this.events[t]=false;this.proxy.send({type:s,service:this.id,method:"ignore",event:t})}}},{"./NextGenEvents.js":1}],3:[function(e,t,n){"use strict";if(typeof window.setImmediate!=="function"){window.setImmediate=function i(e){setTimeout(e,0)}}t.exports=e("./NextGenEvents.js");t.exports.isBrowser=true},{"./NextGenEvents.js":1}]},{},[3])(3)});